# T02. –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
## 1.  –ë–∞–∑–æ–≤–∞—è –≤–µ—Ä—Å–∏—è
–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ —è–∑—ã–∫–µ C# (–∏–ª–∏ –Ω–∞ Node.js, –∏—Å–ø–æ–ª—å–∑—É—è —Ç–æ–ª—å–∫–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–æ–¥—É–ª–∏ + –º–æ–¥—É–ª—å —Ä–∞–±–æ—Ç—ã —Å –ë–î) –ø—Ä–æ–≥—Ä–∞–º–º—É —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ö–µ–º—ã —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –ë–î

–í –∫–∞—á–µ—Å—Ç–≤–µ –ë–î –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
- SQLite
- MSSQL
- MySQL
- –∏–ª–∏ PostgreSQL

–°—Ö–µ–º–∞ –ë–î, –∫–æ—Ç–æ—Ä–∞—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω–∞, –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è JSON-—Ñ–∞–π–ª–æ–º —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:
```
[<–¢–∞–±–ª–∏—Ü–∞ 1>, <–¢–∞–±–ª–∏—Ü–∞ 2>,<–¢–∞–±–ª–∏—Ü–∞ 3>]
```
–≥–¥–µ `<–¢–∞–±–ª–∏—Ü–∞ N>`:

```
{
  "name": "–ò–º—è —Ç–∞–±–ª–∏—Ü—ã",
  "fields": [
    <–ü–æ–ª–µ 1>,
    <–ü–æ–ª–µ 2>,
    <–ü–æ–ª–µ 3>,
  ]
}
```
–≥–¥–µ `<–ü–æ–ª–µ N>`:
```
{
  "name": "–ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–ª—è",
  "type": "–¢–∏–ø –¥–∞–Ω–Ω—ã—Ö"
}

–ò–õ–ò

{
  "name": "–ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–ª—è",
  "link": "–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã"
}
```
–ù–∞–ø—Ä–∏–º–µ—Ä:

```
[
  { 
     "name": "player",
     "fields": [
        {
           "name":  "name",
           "type":  "string"
        },
        {
           "name":  "age",
           "type":  "integer"
        }      
     ]
  },
  {
     "name": "game",
     "field": [
        {
           "name": "created_at",
           "type": "datetime"
        },
        {
           "name": "mode",
           "type": "string"
        }
     ]
  },
  {
     "name": "player_in_game",
     "field": [
        {
           "name": "player_id",
           "link": "player"
        },
        {
           "name": "game_id",
           "link": "game"
        },
        {
           "name": "is_winner",
           "link": "bool"
        }
     ]
  }
]
```

–ü–æ–º–∏–º–æ –ø–æ–ª–µ–π, –æ–ø–∏—Å–∞–Ω–Ω—ã—Ö —è–≤–Ω–æ, –∫–∞–∂–¥–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–æ–ª–µ `id` —Å –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–æ–º

–í–æ–∑–º–æ–∂–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª–µ–π:
- `bool` -–ª–æ–≥–∏—á–µ—Å–∫–∏–π
- `integer` - —Ü–µ–ª—ã–π
- `string` - —Å—Ç—Ä–æ–∫–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –¥–ª–∏–Ω—ã (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–∞–¥–∞–π—Ç–µ —Å–∞–º–∏)
- `text` - —Å—Ç—Ä–æ–∫–∞ –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –¥–ª–∏–Ω—ã
- `datetime` - –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è

–ü–æ–ª—è —Å `link`, –≤–º–µ—Å—Ç–æ —É–∫–∞–∑–∞–Ω–∏—è —Ç–∏–ø–∞, –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–Ω–µ—à–∏–Ω–∏–º–∏ –∫–ª—é—á–∞–º–∏ –∫ —Å–æ–æ—Ç–≤–µ—Ç–≤—É—é—â–µ–π —Ç–∞–±–ª–∏—Ü–µ (—Å–≤—è–∑—å –ø–æ `id`)

–ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–æ–ª–∂–Ω–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å—ã —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∏—Ö –≤ __–æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏__

## 2. –ú–∏–≥—Ä–∞—Ü–∏—è —Å—Ö–µ–º—ã

–ú–æ–¥–µ—Ä–Ω–∏–∑–∏—Ä—É–π—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã –æ–Ω–∞ –ø—Ä–∏–Ω–∏–º–∞–ª–∞ –Ω–∞ –≤—Ö–æ–¥ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º —Ñ–∞–π–ª–æ–π —Å—Ö–µ–º—ã –∏ –æ–±–Ω–æ–≤–ª—è–ª–∞ —Å—Ö–µ–º—É –ë–î –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å–≤–∏–∏ —Å –ø–æ—Å–ª–µ–¥–Ω–∏–º –∏–∑ —Ñ–∞–π–ª–æ–≤ –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É. 

–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã.  –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –µ—Å—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Ñ–∞–π–ª—ã:
```
2020-02-20-base.json
2020-02-21-hotfix.json
```
–ë–î –¥–æ–ª–∂–Ω–∞ —Å–æ–∑–¥–∞—Ç—å—Å—è —Å —Å–æ —Å—Ö–µ–º–æ–π `2020-02-21-hotfix.json`. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –±—ã–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ –µ—â–µ –¥–≤–∞ —Ñ–∞–π–ª–∞:
```
2020-02-20-base.json
2020-02-21-hotfix.json
2020-02-23-party-update.json
2020-02-24-after-party-fix.json
```
–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã, —Å—Ö–µ–º–∞ –ë–î –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å–æ —Å—Ö–µ–º–æ–π `2020-02-24-after-party-fix.json`

–ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ö–µ–º—ã –ë–î –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã —Ç–æ–ª—å–∫–æ —Ç–µ —Ç–∞–±–ª–∏—Ü—ã –∏ –ø–æ–ª—è, –∫–æ—Ç–æ—Ä—ã–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å (—Ç.–µ. –Ω–µ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å `DROP` –≤—Å–µ–π –±–∞–∑—ã –∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –µ–µ –ø–æ-–Ω–æ–≤–æ–π üòâ)

–î–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π —Å–æ–∑–¥–∞–π—Ç–µ —Å–ª—É–∂–µ–±–Ω—É—é —Ç–∞–±–ª–∏—Ü—É `migration`, –≤ –∫–æ—Ç–æ—Ä—É—é –ø–æ–º–µ—Å—Ç–∏—Ç–µ JSON —Ñ–∞–π–ª —Ç–µ–∫—É—â–µ–π —Å—Ö–µ–º—ã –ë–î. –ü–æ—Å–ª–µ –æ—á–µ—Ä–µ–¥–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã, –æ—Ç–∫—Ä–æ–π—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ñ–∞–π–ª –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏ —Å–æ–ø–æ—Å—Ç–∞–≤—å—Ç–µ –µ–≥–æ —Å JSON-—Ñ–∞–π–ª–æ–º, –ª–µ–∂–∞—â–∏–º –≤ —Ç–∞–±–ª–∏—Ü–µ `migration`

–ü–æ—Å–∫–æ–ª—å–∫—É `migration` - —Å–ª—É–∂–µ–±–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞, —Ç–æ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —É–∫–∞–∑–∞—Ç—å –µ–µ –≤ JSON-—Å—Ö–µ–º–µ, –æ—Ç–æ–±—Ä–∞–∑–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ.

–ö–∞–∫ –∏ –ø—Ä–µ–∂–¥–µ, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –≤ –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

## 3. –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö 
–†–∞—Å—à–∏—Ä—å—Ç–µ JSON-—Å—Ö–µ–º—É, —Ç–µ–ø–µ—Ä—å –ø–æ–º–∏–º–æ –æ–ø–∏—Å–∞–Ω–∏—è –ø–æ–ª–µ–π —Ç–∞–±–ª–∏—Ü –≤ –Ω–µ–π –±—É–¥—É—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –≤ –ø–æ–ª–µ `data`, –Ω–∞–ø—Ä–∏–º–µ—Ä:
```
[
  { 
     "name": "player",
     "fields": [
        {
           "name":  "name",
           "type":  "string"
        },
        {
           "name":  "age",
           "type":  "integer"
        }      
     ],
     "data": [
        {
           "id": 1,
           "name": "Mike",
           "age":  20
        },
        {
           "id": 2,
           "name": "John",
           "age": 32
        },
        {
           "id": 3,
           "name": "Tom",
           "age": 23
        },
        {
           "id": 4,
           "name": "Sam",
           "age": 10
        }
     ]
  },
  {
     "name": "game",
     "field": [
        {
           "name": "created_at",
           "type": "datetime"
        },
        {
           "name": "mode",
           "type": "string"
        }
     ],
     "data": [
       {
		   "id": 1,
           "created_at": "2020-02-05T09:04:00",
           "mode": "deathmatch"
       },
       {
		   "id": 2,
           "created_at": "2020-01-03T10:06:00",
           "mode": "team"
       }
     ]
  },
  {
     "name": "player_in_game",
     "field": [
        {
           "name": "player_id",
           "link": "player"
        },
        {
           "name": "game_id",
           "link": "game"
        },
        {
           "name": "is_winner",
           "link": "bool"
        }
     ],
     "data": [
        {
		   "id": 1,
           "player_id": 1,
           "game_id": 1,
           "is_winner": true
        },
        {
		   "id": 2,
           "player_id": 2,
           "game_id": 1,
           "is_winner": false
        },
        {
		   "id": 3,
           "player_id": 1,
           "game_id": 2,
           "is_winner": true
        },
        {
		   "id": 4,
           "player_id": 2,
           "game_id": 2,
           "is_winner": false
        },
        {
		   "id": 5,
           "player_id": 3,
           "game_id": 2,
           "is_winner": false
        },
        {
		   "id": 6,
           "player_id": 4,
           "game_id": 2,
           "is_winner": true
        }          
     ]
  }
]
```

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –≤—ã –¥–æ–ª–∂–Ω—ã –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü:
- –µ—Å–ª–∏ –≤ –ë–î –Ω–µ—Ç –∑–∞–ø–∏—Å–∏ —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º –≤ JSON-—Ñ–∞–π–ª–µ `id`, –∑–∞–ø–∏—Å—å –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å
- –µ—Å–ª–∏ –≤ –ë–î —É–∂–µ –µ—Å—Ç—å –∑–∞–ø–∏—Å—å —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º `id`, —Ç–æ –µ–µ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å
- –∑–∞–ø–∏—Å–∏, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤ JSON-—Ñ–∞–π–ª–µ –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å

–£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å —Ç–æ–ª—å–∫–æ —Å —Ç–µ–º–∏, –∑–∞–ø–∏—Å—è–º–∏, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤ JSON-—Ñ–∞–π–ª–µ

–ù–∞–ø—Ä–∏–º–µ—Ä, –¥–æ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ `player_in_game` –±—ã–ª–∏ —Å–ª–µ–¥—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ:

Id | player_id | game_id | is_winner
--|-----------|-----------|----------
1|  1 | 1 | false
2|  2 | 1 | true
5|  3 | 2 | false
6|  4 | 2 | true
7| 1 | 2 | false

–ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –≤—ã –¥–æ–ª–∂–Ω—ã –ø–æ–ª—É—á–∏—Ç—å:

Id | player_id | game_id | is_winner | –î–µ–π—Å—Ç–≤–∏–µ
--|-----------|-----------|---------- | -----
1|  1 | 1 | true | __UPDATE__
2|  2 | 1 | false  | __UPDATE__
3| 1 | 2 | true  | __INSERT__
4| 2 | 2 | false | __INSERT__
5|  3 | 2 | false| -
6|  4 | 2 | true | -
~~7~~| ~~1~~ | ~~2~~ | ~~false~~ | __DELETE__
